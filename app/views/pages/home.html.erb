<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cafe API ‚òïÔ∏è</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  </head>
  <body class="bg-dark text-white">
    <div class="container mt-5">
      <div class="row justify-content-center">
        <div class="col-12 col-md-6">
          <h1 class='text-center'>Cafe API ‚òïÔ∏è</h1>
          <p>
            This API was built for a Rails API workshop. The documentation can be found
            <%= link_to 'here üîó', 'https://github.com/dmbf29/rails-api-tutorial', class: 'text-decoration-none text-secondary'  %>
          </p>
        </div>
      </div>
      <div class="row justify-content-center mt-4">
        <div class="col-12 col-md-6">
          <h4 class='text-center'>Try it here</h4>
          <form>
            <div class="input-group mb-0">
              <span class="input-group-text" id="basic-addon3">https://BASE_URL/api/v1/</span>
              <input type="text" class="form-control" value="cafes" aria-label="cafes" aria-describedby="button-addon2">
              <button class="btn btn-secondary" type="button" id="button-addon2">Search</button>
            </div>
            <div class="form-text text-white mt-1" id="basic-addon4">Endpoints: <code>/cafes</code>, <code>/cafes?title=shinjuku</code>, <code>/criteria</code></div>
          </form>
        </div>
      </div>
      <div class="row justify-content-center mt-3">
        <div class="col-12 col-md-6">
          <h6>Result:</h6>
          <div class="input-group">
            <textarea class="form-control" aria-label="results area" style="height: 400px; overflow: scroll;"></textarea>
          </div>
        </div>
      </div>
    </div>
    <script>
      document.querySelector('#button-addon2').addEventListener('click', async () => {
        // TODO: Change this to your endpoint in production
        const url = `http://localhost:3000/api/v1/${document.querySelector('input').value}`;
        console.log(url);

        const response = await fetch(url);
        const data = await response.json();
        document.querySelector('textarea').value = JSON.stringify(data, null, 2);
      });
    </script>
  </body>
</html>
